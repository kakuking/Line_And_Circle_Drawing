<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L-Systems docs</title>
</head>

<!-- To get lato -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Lato:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'lato', sans-serif;
        background-color: #b5eaff;

        padding: 10px;
    }

    #header {
        display: flex;
        justify-content: center;
    }

    h1{
        text-decoration: double underline;
    }

    .production{
        text-align: center;
        font-size: large;
    }

    .controls{
        display: flex;
        justify-content: center;
    }

    .btnControl{
        background: none;
        border: solid 2px  #52cafa;
        font: inherit;
        cursor: pointer;

        padding: 10px;
        margin: 10px;

        transition: all 0.5s ease;
    }

    .btnControl:hover{
        background-color: #52cafa;
    }

    img {
        max-width: 70%;
        max-height: 100%;
    }

    .image{
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .iteration{
        text-align: center;
    }


</style>

<script>

    function sampleSwap(){
        let sampleImg = document.getElementById("sampleImg");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);

        if(curImg.substring(0, curImg.length - 5) == "/prod1_30_100_images/prod1_")
            sampleImg.setAttribute('src', "/prod1_30_100_images/prod1_Alt_" + curIt + ".jpg");
        else
        sampleImg.setAttribute('src', "/prod1_30_100_images/prod1_" + curIt + ".jpg");
    }

    function sampleNext(aheadOrBack){
        let sampleImg = document.getElementById("sampleImg");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 8;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 7;
        }

        sampleImg.setAttribute('src', curImg.substring(0, curImg.length - 5) + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("sampleIteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("sampleIteration").innerHTML 
            = "Current Iteration: 8"
        }
    }

    function sample90Next(aheadOrBack){
        let sampleImg = document.getElementById("sample90Img");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 9;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 8;
        }

        sampleImg.setAttribute('src', "/prod1_30_90_images/prod1_" + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("sample90Iteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("sample90Iteration").innerHTML 
            = "Current Iteration: 9"
        }
    }

    function sample75Next(aheadOrBack){
        let sampleImg = document.getElementById("sample75Img");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 10;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 9;
        }

        sampleImg.setAttribute('src', "/prod1_30_75_images/prod1_" + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("sample75Iteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("sample75Iteration").innerHTML 
            = "Current Iteration: 10"
        }
    }

    function graph45Next(aheadOrBack){
        let sampleImg = document.getElementById("graph45Img");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 9;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 8;
        }

        sampleImg.setAttribute('src', "/prod1_45_90_images/prod1_" + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("graph45Iteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("graph45Iteration").innerHTML 
            = "Current Iteration: 9"
        }
    }

    function prod2Next(aheadOrBack){
        let sampleImg = document.getElementById("prod2Img");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 8;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 7;
        }

        sampleImg.setAttribute('src', "/prod2_45_75_images/prod1_" + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("prod2Iteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("prod2Iteration").innerHTML 
            = "Current Iteration: 8"
        }
    }

    function prod3Next(aheadOrBack){
        let sampleImg = document.getElementById("prod3Img");
        let curImg = sampleImg.getAttribute('src');
        let curIt = +curImg.charAt(curImg.length - 5);
        curIt += aheadOrBack;
        curIt = curIt % 8;

        if(curIt == -1 && aheadOrBack == -1){
            curIt = 7;
        }

        sampleImg.setAttribute('src', "/prod3/prod1_" + curIt + ".jpg");
        
        
        if(curIt != 0){
            document.getElementById("prod3Iteration").innerHTML
            = "Current Iteration: " + curIt;
        } else{
            document.getElementById("prod3Iteration").innerHTML 
            = "Current Iteration: 8"
        }
    }
</script>

<body>
    <h1 id="header">Lindenmayer systems</h1>
    <h2 id="header">Kartikeya Dubey - 2020A7PS0031H</h2>
    <h3 id="header">Group E</h3>
    <div class="description">
        Since Lindenmayer introduced the idea of using grammars 
        to develop biological systems, the idea has recieved great interest.
        Our interest lies in these L-systems, particularly the 0L-systems. As
        proposed in the paper 
        <a style="font-weight: bolder;" href="https://dl.acm.org/doi/abs/10.1145/964965.808571" target="_blank">
            Plants, fractals and formal languages by Alvy Ray Smith
        </a>
        , we will be attempting to implement the bracketed L-systems as described by
        Lindenmayer himself. In these bracketed L-systems, the alphabet is augmented
        by the set <strong>{</strong>'[', ']', '(', ')'<strong>}</strong>. Furthermore, these brackets are only 
        structural markers, with the brackets producing only themselves. 
        i.e.,
        <br>
    </div>
    <div class="production">
        [ → [
        <br>
        ] → ]
        <br>
        ( → (
        <br>
        ) → )
    </div>
    <div class="description">
        Next, each member of the alphabet is given a corresponding action:
    </div>
    <div class="production">
        0 → Draw forwards for 1 unit
        <br>
        1 → Draw forwards for 1 unit
        <br>
        [ → Push position and rotation to stack and turn left by <strong>n</strong> degrees
        <br>
        ( → Push position and rotation to stack and turn right by <strong>n</strong> degrees
        <br>
        ] → Pop position and rotation from stack
        <br>
        ) → Pop position and rotation from stack
    </div>
    <div class="description">
        <br>
        <strong>Keeping the productions of the brackets consistent across our grammars,</strong> below,
        you can find the output generated by the L-system algorithm with some sample
        productions.
        <br>
        <br>
        First, to show the baseline, we have used the following productions:
        <br>
        <strong>NOTE: The productions for the brackets will be consistent across all the examples, with the only thing changing being the degrees (<i>n</i>) of the turn</strong>
    </div>
    <div class="production">
        0 → 1[0]1(0)0
        <br>
        1 → 11
        <br>
        degree of turn: 30°
    </div>
    <div class="controls">
        <button class="btnControl" onclick="sampleNext(-1)">← Prev</button>
        <button class="btnControl" onclick="sampleSwap()">Swap View</button>
        <button class="btnControl" onclick="sampleNext(1)">Next →</button>
    </div>
    <div class="image">
        <div class="iteration">
            For this production, we have included a alternate view with which you can see each 
            segment with an alternate color to better understand which production produced
            which segment
        </div>
        <div id="sampleIteration" class="iteration">Current Iteration: 1</div>
        <img id="sampleImg" src="/prod1_30_100_images/prod1_1.jpg" alt="" srcset="">
    </div>
    <div class="description">
        <br>
        As can be seen above, if we keep the length consistently 20px between generations,
        we quickly run out of space to render the L-system. So, to combat this, we have added
         a decay to the length in every successive generations - 
    </div>
    <div class="production">
        len_new = x * len_old
        <br>
        where 0 < x ≤ 1
    </div>
    <div class="description">
        Now, every time a new iteration occurs, the length reduces, allowing us to 
        view more iterations in the same amount of space.
         Consider the same production now with a decay of <strong><i>x = 0.9</i></strong>
    </div>
    <div class="controls">
        <button class="btnControl" onclick="sample90Next(-1)">← Prev</button>
        <button class="btnControl" onclick="sample90Next(1)">Next →</button>
    </div>
    <div class="image">
        <div id="sample90Iteration" class="iteration">Current Iteration: 1</div>
        <img id="sample90Img" src="/prod1_30_90_images/prod1_1.jpg" alt="" srcset="">
    </div>
    <div class="description">
        This time, we could go up to 9 iterations. Again,
         consider the same production now with a decay of <strong><i>x = 0.75</i></strong>
    </div>
    <div class="controls">
        <button class="btnControl" onclick="sample75Next(-1)">← Prev</button>
        <button class="btnControl" onclick="sample75Next(1)">Next →</button>
    </div>
    <div class="image">
        <div id="sample75Iteration" class="iteration">Current Iteration: 1</div>
        <img id="sample75Img" src="/prod1_30_75_images/prod1_1.jpg" alt="" srcset="">
    </div>
    <div class="description">
        <br>
        This time we can go up to 10 iterations. However, now we run into another issue,
         due to the decay, we quickly reach the point where <strong>len_new < 1</strong>
         i.e., no pixels are rendered.
         <br>
        Here, you can see the timing data for this algorithm,
        since the first 2 iterations take close to 0 μs, they occur anomalously on the graph. 
        The algorithm is roughly exponential since the logarithmic graph is roughly linear
        <br>
        <br>    
    </div>
    <div class="image">
        <img src="/Time_scale.png" alt="">
    </div>
    <div class="description">
        <br>
        Moving on, we have also developed the same grammar but with 
         <strong><i>n = 45°</i></strong>
    </div>
    <div class="controls">
        <button class="btnControl" onclick="graph45Next(-1)">← Prev</button>
        <button class="btnControl" onclick="graph45Next(1)">Next →</button>
    </div>
    <div class="image">
        <div id="graph45Iteration" class="iteration">Current Iteration: 1</div>
        <img id="graph45Img" src="/prod1_45_90_images/prod1_1.jpg" alt="" srcset="">
    </div>
    <div class="description">
        <br>
        Next, we have also developed the another grammar. In this grammar, please note that
        the closing bracket, ']' also causes the angle to turn right by <strong>n°</strong>,
        much like the opening parenthesis, '(' does normally. The grammar is: 
    </div>
    <div class="production">
        0 → 1[0]0
        <br>
        1 → 11
        <br>
        degree of turn: 30°
    </div>
    <div class="controls">
        <button class="btnControl" onclick="prod2Next(-1)">← Prev</button>
        <button class="btnControl" onclick="prod2Next(1)">Next →</button>
    </div>
    <div class="image">
        <div id="prod2Iteration" class="iteration">Current Iteration: 1</div>
        <img id="prod2Img" src="/prod2_45_75_images/prod1_1.jpg" alt="" srcset="">
    </div>
    <div class="description">
        <br>
        Now, we have another  grammar, + causes the angle to turn by <i>n°</i> to the left,
         - to the left. This grammar generates a "plant" that seems more natural than the others, with a windswept look to it.
    </div>
    <div class="production">
        0 → 1+[[0]-0]-1[-10]+0
        <br>
        1 → 11
        <br>
        degree of turn: 25°
    </div>
    <div class="controls">
        <button class="btnControl" onclick="prod3Next(-1)">← Prev</button>
        <button class="btnControl" onclick="prod3Next(1)">Next →</button>
    </div>
    <div class="image">
        <div id="prod3Iteration" class="iteration">Current Iteration: 1</div>
        <img id="prod3Img" src="/prod3/prod1_1.jpg" alt="" srcset="">
    </div>
    <h1 id="header">Thank You</h1>
</body>
</html>